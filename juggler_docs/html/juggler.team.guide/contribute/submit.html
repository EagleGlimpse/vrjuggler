<HEAD>
<TITLE>Creating and Submitting Patches to VR Juggler</TITLE>
</HEAD>

<BODY>

<H2><IMG SRC="${IMAGES}/open_file.gif" HEIGHT="32"> Creating and Submitting
Patches</H2>

<!-- install-web toc-begin -->
<H3>Table of Contents:</H3>

  <OL>
    <LI>
      <A HREF="#intro">Introduction</A>
    </LI>
    <LI>
      <A HREF="#recommend">Recommended Reading</A>
    </LI>
    <LI>
      <A HREF="#create">Making a Patch</A>

      <OL TYPE="i">
        <LI>
          <A HREF="#CVS">Using CVS to Make a Patch</A>
        </LI>
        <LI>
          <A HREF="#diff">Using <TT>diff</TT>(1) to Make a Patch</A>
        </LI>
        <LI>
          <A HREF="#formats">Patch Formats</A>
        </LI>
      </OL>
    </LI>
    <LI>
      <A HREF="#submit">Submitting Patches</A>

      <OL TYPE="i">
        <LI>
          <A HREF="#bug">Submitting Bug Fixes</A>
        </LI>
        <LI>
          <A HREF="#enhance">Submitting Feature Enhancements</A>
        </LI>
        <LI>
          <A HREF="#addition">Submitting Feature Additions</A>
        </LI>
      </OL>
    </LI>
  </OL>
<!-- install-web toc-end -->

<H4><A NAME="intro">Introduction</A></H4>

  <P>
    This document explains in detail how to create patches to the VR Juggler
    developers for reviewing and (hopefully) committing, and it provides
    pointers on what the best audience for your patch may be.  The
    information presented is based on the method used by the UNIX
    <TT>diff</TT>(1) and <TT>patch</TT>(1) utilities because that is what
    CVS uses.
  </P>

<H4><A NAME="recommend">Recommended Reading</A></H4>

  <UL>
    <LI>
      <A HREF="${TEAMGUIDE}/contribute/rules.html">Rules for making
      contributions</A>
    </LI>
    <LI>
      CVS documentation
    </LI>
    <LI>
      <TT>diff</TT>(1) man page
    </LI>
  </UL>

<H4><A NAME="create">Making a Patch</A></H4>

  <P>
    There are two ways to create a patch to the VR Juggler source: using a
    copy of the source code checked out from CVS or making a comparison
    against an unmodified copy of a file.  The first way is more convenient,
    but the second method does not necessarily require CVS knowledge.
  </P>

<H5><A NAME="CVS">Using CVS to Make a Patch</A></H5>

  <P>
    If you have checked out a copy of the VR Juggler source code and have
    been modifying the code in that tree, making a patch (big or small) is
    easy.  (Refer to the CVS documentation for information on how to check
    out a copy of VR Juggler from the CVS repository.)  You can edit the
    checked-out file(s) all you want without retaining a backup copy
    because you can always get an unmodified version from the repository.
  </P>

  <P>
    Once your work is done and you are ready to create the patch, you
    want to use the <TT>cvs diff</TT> command to get the differences between
    the original version and your new work.  This command is a capable of
    doing a lot more than just creating patches, but we will focus only on
    that aspect of it here.  Assuming a shell that allows redirection of
    standard output to a file, the command should be used as follows to
    create the patch for a single file:

<PRE>
    % <B>cvs diff <I>filename</I> &gt; <I>filename</I>.patch</B>
</PRE>

    Since CVS knows about the entire repository, you can use <TT>cvs diff</TT>
    to make a larger patch of several files, a single directory, a
    subtree of the larger directory tree or the entire VR Juggler source
    tree.  You should be careful to keep only related patches together in
    a single file.  Examples of how to perform each of these operations
    follow.

    <UL>
      <LI>
        Patching several files:

<PRE>
    % <B>cvs diff <I>filename1</I> <I>filename2</I> ... &gt; patch</B>
</PRE>

        You can of course use wildcard expansions here as supported by
        your shell.
      </LI>
      <LI>
        Patching all the files in a directory (either the current directory
        or some subdirectory of the whole VR Juggler source tree):

<PRE>
    % <B>cvs diff <I>directory_name</I> &gt; patch</B>
</PRE>

        Here, you can use `<TT>.</TT>' to represent the current directory
        as usual.  If the directory you are patching contains subdirectories,
        CVS will recurse into those by default and perform the diff operation
        there as well.  To prevent recursion, use the standard <TT>-l</TT>
        (local) CVS command option:

<PRE>
    % <B>cvs diff -l <I>directory_name</I> &gt; patch</B>
</PRE>
      </LI>
      <LI>
        Creating a patch against the entire VR Juggler source tree works
        just the same as the previous method except that is executed from
        the top-level directory of the source tree.
      </LI>
    </UL>
  </P>

<H5><A NAME="diff">Using <TT>diff</TT>(1) to Make a Patch</A></H5>

  <P>
    Instead of using CVS to get the source and make the comparison (which
    can be slow if your network connection to SourceForge is hurting), it
    is possible to make a patch the ``old-fashioned way''.  Before editing
    a file, however, <B>make sure to save a backup copy of it</B>.  You
    need this for comparison once your modifications are complete.  The
    common convention is to make a copy the old file with the same name
    and extra extension <TT>.orig</TT> (for example,
    <TT>vjThread.cpp<I>.orig</I></TT>).  Once you are satisfied that your
    work is complete, use the <TT>diff</TT>(1) utility to create the
    patch as follows (assuming a shell that supports redirection of
    standard out to a file):

<PRE>
    % <B>diff [options] <I>filename</I>.orig <I>filename</I> &gt; <I>filename</I>.patch</B>
</PRE>

    This must be repeated for every modified file.  Make sure that the
    original file always goes <I>first</I>.
  </P>

  <P>
    A nice thing about the <TT>patch</TT>(1) utility is that it can extract
    multiple patches from a single file.  Submitting a single file is
    certain to make the developers happier than dealing with individual
    patch files for every file you modified.  (Of course, you should not
    just lump all your patches into one file if they are unrelated.  Use
    common sense when creating the patch files, and everything will be
    fab.)  Assuming a UNIX or UNIX-like shell with redirection and
    appending of files, there are two ways to combine individual patches
    into a single file:

    <OL>
      <LI>
        Create a patch file and append subsequent patches to it:

<PRE>
    % <B>diff [options] <I>filename1</I>.orig <I>filename1</I> &gt; $HOME/my.patch</B>
    % <B>diff [options] <I>filename2</I>.orig <I>filename2</I> &gt;&gt; $HOME/my.patch</B>
    % ...
</PRE>
      </LI>
      <LI>
        If that does not suit you, you can use the simple yet powerful
        <TT>cat</TT>(1) command to concatenate all your distinct patch files
        into one big patch:

<PRE>
    % <B>diff [options] <I>filename1</I>.orig <I>filename1</I> &gt; $HOME/<I>filename1</I>.patch</B>
    % <B>diff [options] <I>filename2</I>.orig <I>filename2</I> &gt;&gt; $HOME/<I>filename2</I>.patch</B>
    % ...
    % <B>cat $HOME/<I>filename1</I>.patch $HOME/<I>filename2</I>.patch ... > my_big_patch</B>
</PRE>
      </LI>
    </OL>
  </P>

<H5><A NAME="formats">Patch Formats</A></H5>

  <P>
    There are three styles of diffs that can be generated for use as
    patches: standard diff, unified diff and context diff.  In the author's
    experience, unified diffs are the easiest to read, and standard diffs
    are the hardest to read.  The following two pages from the enline VR
    Juggler CVS repository show how unified and context diffs look:

    <UL>
      <LI>
        <A HREF="http://cvs.sourceforge.net/cgi-bin/cvsweb.cgi/juggler/configure.in.diff?cvsroot=vrjuggler&r1=text&tr1=1.259&r2=text&tr2=1.260&f=u">Unified
        diff</A> between Revisions 1.259 and 1.260 of <TT>configure.in</TT>
      </LI>
      <LI>
        <A HREF="http://cvs.sourceforge.net/cgi-bin/cvsweb.cgi/juggler/configure.in.diff?cvsroot=vrjuggler&r1=text&tr1=1.259&r2=text&tr2=1.260&f=c">Context
        diff</A> between Revisions 1.259 and 1.260 of <TT>configure.in</TT>
      </LI>
    </UL>

    We cannot generate <A HREF="http://cvs.sourceforge.net/cgi-bin/cvsweb.cgi/juggler/configure.in.diff?cvsroot=vrjuggler&r1=text&tr1=1.259&r2=text&tr2=1.260&f=h">fancy,
    colored diffs</A> for use as patches unfortunately.  It certainly is
    nice that
    <A HREF="http://stud.fh-heilbronn.de/~zeller/cgi/cvsweb.cgi/" TARGET="_top"><I>cvsweb</I></A>
    will do that, however.
  </P>

  <P>
    To generate a unified diff, specify the option <TT>-u</TT> on the
    command line when running the diff command.  To create a context diff,
    specify the <TT>-c</TT> option instead.  To create a standard diff,
    give no options at all.  These work with both the CVS diff command and
    the <TT>diff</TT>(1) utility.  To always create a specific kind of diff
    by default with CVS, add the following line to your
    <TT>$HOME/.cvsrc</TT> file:

<PRE>
    diff <I>option</I>
</PRE>
  </P>

<H4><A NAME="submit">Submitting Patches</A></H4>

  <P>
    Now that you have made your patches, it's time to send them off to the
    VR Juggler developers with commit access so that they can review them,
    commit them and praise you for your fine efforts.  Before reading this
    section, please be sure to have read
    <A HREF="${TEAMGUIDE}/contribute/rules.html">the rules for
    contributions</A>.  Failing to follow these rules could result in your
    slow review and/or acceptance of your patches.  What is presented here
    will repeat some of what is written in that document, but it is
    important to read both.
  </P>

  <P>
    The method used to present your patches to the committers depends on
    what kind of patches you have made.  As of this writing, the most
    common types of patches we would like to see and expect to see are
    as follows:

    <UL>
      <LI>
        <B>Bug fixes</B>: VR Juggler is not free of bugs, and patches from
        users who fix bugs are very welcome
      </LI>
      <LI>
        <B>Feature enhancements</B>: VR Juggler offers a lot of features to
        users, but some interfaces may be incomplete or could be further
        extended
      </LI>
      <LI>
        <B>Feature additions</B>: VR Juggler needs more device drivers and
        abstractions useful to programmers who are developing VR applications
        every day
      </LI>
    </UL>

    If your patch is accepted, you will be given proper credit in the
    commit log as follows:

<PRE>
    <I>Description of patch</I>

        Submitted by: Helpful User &lt;great.person@wonderful.net&gt;
</PRE>
  </P>

<H5><A NAME="bug">Submitting Bug Fixes</A></H5>

  <P>
    This is probably the most common type of patch VR Juggler users will
    submit.  The best way to submit a patch for a bug is to attach it to
    a <A HREF="${JUGGLERBUGS}" TARGET="_top">bug report</A> through
    <A HREF="${SOURCEFORGE}" TARGET="_top">SourceForge</A>.  Copies of bug
    reports are sent to
    <A HREF="${JUGGLER_DEV_MAILING_LIST}">vrjuggler-devel@lists.sourceforge.net</A>
    where all subscribers of that list see them.  The bug report will be
    assigned to a developer with commit access, and that person will take
    charge of reviewing your patch and any further communication with you,
    the helpful submitter.
  </P>

<H5><A NAME="enhance">Submitting Feature Enhancements</A></H5>

  <P>
    Submitting an enhancement to existing code requires a little bit more
    work than submitting a bug report.  If you are implementing part of an
    interface that is not yet finished (for example, a method that only
    prints out ``Not implemented yet!''), you should submit a
    <A HREF="${JUGGLERBUGS}" TARGET="_top">bug report</A> as above but
    describe it as a feature enhancement in your report.  If you are
    extending an interface, you should first submit your proposed changes
    (in a high-level format with some pseudocode if appropriate) to
    <A HREF="${MAILTO_JUGGLER_DEV_MAILING_LIST}">vrjuggler-devel@lists.sourceforge.net</A>
    for discussion before doing any hard work making the changes.  This
    will allow interested people to respond with feedback, questions or
    a short ``Go for it!'' message.  Once your patches are ready, then
    you should submit them to the list for reviewing before an interested
    committer will take them and actually commit them.
  </P>

<H5><A NAME="addition">Submitting Feature Additions</A></H5>

  <P>
    Feature additions stand to be controversial if not presented properly.
    For example, if you want to submit a complex computational geometry
    algorithm implementation, you had better have a really good reason.
    The first step you should take is a high-level proposal to
    <A HREF="${MAILTO_JUGGLER_DEV_MAILING_LIST}">vrjuggler-devel@lists.sourceforge.net</A>
    which will no doubt generate much good discussion among developers.
    This step is encouraged to find out if people are interested in seeing
    your features as a part of the core VR Juggler library or would prefer
    to see them as something written at a higher level using VR Juggler as
    a basis.  No one wants to see talented people doing a lot of work only
    to have it rejected because it doesn't fit with the intended design and
    use of a given project.  (This is not intended to discourage people
    from trying to extend the design of VR Juggler but instead to suggest
    that VR Juggler be used as a <I>basis</I> for more complex tools when
    appropriate.)
  </P>

  <P>
    After your proposal has been refined and heartily accepted, it's time
    for you to get to work on making the changes.  Periodic progress
    reports are helpful so that the developers know that you are still
    hard at work and have not given up for lack of time or resources.
    Posting developmental patches at key stages helps too because the
    patches can be tested by other developers who can then provide
    feedback and bug reports.
  </P>

  <P>
    Once your changes are ready (or some stage of your changes is ready
    to be committed), post your triumphant message with the attached
    patches.  After all the traffic generated because of your work, the
    committers will no doubt jump at the chance to commit your changes
    and make them available to the community of users.
  </P>

</BODY>
