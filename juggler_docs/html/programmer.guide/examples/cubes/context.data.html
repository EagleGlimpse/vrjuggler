<html>

<head>
<title>Context Specific Data</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">


<meta name="Microsoft Border" content="tb">
</head>

<body><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>

<p align="left"><font size="6"><strong>Context Specific Data</strong></font></p>

</td></tr><!--msnavigation--></table><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><!--msnavigation--><td valign="top">
<div align="left">

<table border="0" width="94%" height="1">
  <tr>
    <td width="15%" height="1"></td>
    <td width="85%" height="84"><div align="left"><table border="0">
      <tr>
        <td><h3>Overview of context specific data</h3>
        </td>
      </tr>
      <tr>
        <td>The cubes application makes use of context specific data in order to manager OpenGL
        display lists.
        <p>When using context specific data the application does the following:</p>
        <ul>
          <li>Define the class to use for context specific data</li>
          <li>Define a member variable using the context specific template</li>
          <li>Use the context specific object in an application</li>
        </ul>
        <p>&nbsp;</td>
      </tr>
      <tr>
        <td><h3>Required Includes</h3>
        </td>
      </tr>
      <tr>
        <td><pre><font face="System">#include &lt;Kernel/GL/vjGlContextData.h&gt;
</font></pre>
        </td>
      </tr>
      <tr>
        <td>Include the context specific data template delaration.<h3>Define context specific
        class</h3>
        </td>
      </tr>
      <tr>
        <td><pre><font face="System">class UserData
{
public:
   UserData()
   {
      firstTime = true;
      cubeDLIndex = -1;
   }

public:
   bool  firstTime;
   int   cubeDLIndex;
};</font>        </pre>
        </td>
      </tr>
      <tr>
        <td>Any user type may be used to create a context specific object.&nbsp; The only
        restriction is that it must have a default constructor.<p>If a class is to be used to
        create context specific object, it must be defined with a default constructor that fully
        configures the object to be used.&nbsp; There is currently no way to pass parameters to
        the constructor of context specific objects.</p>
        <h3>Define member variable</h3>
        </td>
      </tr>
      <tr>
        <td><pre><font face="System">public:
     vjGlContextData&lt;UserData&gt;  mDlData;       // Data for display lists</font>       </pre>
        </td>
      </tr>
      <tr>
        <td>Context specific objects are declared by creating a template object
        (vjGlContextData&lt;&gt;) with the type of the context specific object passed as the
        template parameter.&nbsp; This will define an object that can be treated just as a pointer
        to the object of the given user type.&nbsp; <h3>Use the object in the application</h3>
        </td>
      </tr>
      <tr>
        <td><pre><font face="System">// Called immediately upon opening a new OpenGL context
   virtual void contextInit()
   {
      // Create display list
      vjASSERT(mDlData-&gt;firstTime == true);   // We should not have been here yet
      mDlData-&gt;firstTime = false;

      glGenLists(rand()%25);        // Generate some random lists.  NOTE: Needed for testing only
      mDlData-&gt;cubeDLIndex = glGenLists(1);

      vjDEBUG(0) &lt;&lt; &quot;Creating DL:&quot; &lt;&lt; mDlData-&gt;cubeDLIndex &lt;&lt; endl &lt;&lt; vjDEBUG_FLUSH;

      glNewList(mDlData-&gt;cubeDLIndex, GL_COMPILE);
         drawbox(-0.5, 0.5, -0.5, 0.5, -0.5, 0.5, GL_QUADS);
      glEndList();
   }</font>        </pre>
        </td>
      </tr>
      <tr>
        <td>The mDlData object is used in the application as a &quot;smart pointer.&quot;
        &nbsp; The system takes care of dereferencing the object in order to provide the
        application with the version of the object for the current OpenGL rendering context. <p>As
        in the example above, the most common use for context specific data objects is to store
        OpenGL display list identifiers.&nbsp; This is because OpenGL display list are required to
        be context specific.</td>
      </tr>
    </table>
    </div><div align="right"><table border="0">
    </table>
    </div></td>
  </tr>
</table>
</div>

<p>&nbsp; 
<!--msnavigation--></td></tr><!--msnavigation--></table><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td><table border="0">
</table></td></tr><!--msnavigation--></table></body>
</html>
