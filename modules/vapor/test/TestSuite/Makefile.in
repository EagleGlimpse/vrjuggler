
###############################################################################$
# builder for test suite.  uses kevin's build system in @srcdir@/mk
###############################################################################$

# project name...
PROJECT_NAME = driver

default: $(PROJECT_NAME)

srcdir		= @srcdir@
topdir		= @topdir@
#top_srcdir	= @top_srcdir@

CC		= @CC@
CXX		= @CXX@
CPP		= @CPP@
CXXCPP		= @CXXCPP@
CFLAGS		= @CFLAGS@ $(OPTIMIZER)
CFLAGS_DYNLIB	= @CFLAGS_DYNLIB@
CPPFLAGS	= @CPPFLAGS@
CXXFLAGS	= @CXXFLAGS@ $(OPTIMIZER)
CXXFLAGS_DYNLIB	= @CXXFLAGS_DYNLIB@
DEFS		= @DEFS@
DEP_GEN_FLAG	= @DEP_GEN_FLAG@
DEPEND_FLAGS	= @DEPEND_FLAGS@ @INCLUDES@ -I$(topdir)			\
                  -I$(VPR_BASE_DIR)/include
DEPEND_EXTRAS	= @DEPEND_EXTRAS@ $(DEFS)
INCLUDES	= @INCLUDES@ -I$(topdir) -I$(VPR_BASE_DIR)/include	\
                 -I$(srcdir) -I$(srcdir)/TestCases			\
                 -I$(srcdir)/CppUnit/framework -I$(srcdir)/CppUnit/textui
INSTALL		= @INSTALL@
LD		= @LD@
LDFLAGS		= @LDFLAGS@ -L/usr/lib$(LIBBITSUF) -L/usr/lib		\
                  -L$(VPR_BASE_DIR)/lib$(LIBBITSUF)
LIBBITSUF	= @LIBBITSUF@
LIBS		= @LIBS@ $(VPR_LIBS)
OBJEXT		= @OBJEXT@
OBJ_NAME_FLAG	= @OBJ_NAME_FLAG@
OS_TYPE		= @OS_TYPE@
LINK		= $(CXX) $(CPPFLAGS) $(CXXFLAGS) @EXTRA_LINK_FLAGS@	\
                  $(EXTRA_FLAGS)

VPR_LIBS	= @APP_VPR_LIBS_BEGIN@ @APP_VPR_LIBS_BASIC@ @APP_VPR_LIBS_END@ @APP_LIBS_BASIC@
EXTRA_LIBS	= @APP_EXTRA_LIBS_BEGIN@ @APP_EXTRA_LIBS_BASIC@ @APP_EXTRA_LIBS_END@

# -----------------------------------------------------------------------------
# Compiler command lines.
# -----------------------------------------------------------------------------
C_COMPILE	= $(CC) $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CFLAGS)
CXX_COMPILE	= $(CXX) $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CXXFLAGS)

# objects to be included in the project....
# SRC Files
TEST_SRCS = 
CPPUNIT_TEXTUI_SRCS = TestRunner.cpp TextTestResult.cpp
CPPUNIT_SRCS = TestCase.cpp \
               TestResult.cpp \
               TestFailure.cpp \
               TestSuite.cpp
TESTDRIVER_SRCS = testSuite.cpp
SRCS	:= $(TEST_SRCS) $(CPPUNIT_TEXTUI_SRCS) $(CPPUNIT_SRCS) $(TESTDRIVER_SRCS)

OBJDIR = .
DEPDIR = 

INCLUDE_PATHS = 
PATH_TO_SRCS = ${srcdir} ${srcdir}/TestCases ${srcdir}/CppUnit/framework ${srcdir}/CppUnit/textui
MK_DIR = ${srcdir}/mk

include ${MK_DIR}/mk.objs

# Compile then Link
$(PROJECT_NAME): $(OBJS)
	@echo ""
	@echo "-------------------------------------------"
	@echo "Linking... (.$(OBJEXT)'s --> executable)"
	@echo "-------------------------------------------"
	$(LINK) -o $@ $(OBJS) $(LDFLAGS) $(LIBS) $(EXTRA_LIBS)
	@echo ""
	@echo "-------------------------------------------"
	@echo "$(PROJECT_NAME) done"
	@echo "-------------------------------------------"

# Remove the compiled stuff from the system
clean:
	@echo ""
	@echo "-------------------------------------------"
	@echo "Removing compiled stuff from the system	 "
	@echo "-------------------------------------------"
	rm -fr $(OBJS) $(PROJECT_NAME) *.ncb *.opt *.plg *.ilk *.idb	\
          *.pdb *.pch Debug/ Release/ ii_files/

clobber: clean
	rm -f *.d

include ${MK_DIR}/mk.depend

