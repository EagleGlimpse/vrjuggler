# ************** <auto-copyright.pl BEGIN do not edit this line> **************
#
# VR Juggler is (C) Copyright 1998, 1999, 2000, 2001 by Iowa State University
#
# Original Authors:
#   Allen Bierbaum, Christopher Just,
#   Patrick Hartling, Kevin Meinert,
#   Carolina Cruz-Neira, Albert Baker
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Library General Public
# License as published by the Free Software Foundation; either
# version 2 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Library General Public License for more details.
#
# You should have received a copy of the GNU Library General Public
# License along with this library; if not, write to the
# Free Software Foundation, Inc., 59 Temple Place - Suite 330,
# Boston, MA 02111-1307, USA.
#
# *************** <auto-copyright.pl END do not edit this line> ***************

###############################################################################$
# builder for test suite.  uses kevin's build system in @srcdir@/mk
###############################################################################$

# project name...
PROJECT_NAME = runner@EXEEXT@

default: echo_info $(PROJECT_NAME)

srcdir		= @srcdir@
topdir		= @topdir@
#top_srcdir	= @top_srcdir@
JCCL_BASE_DIR	?= @APP_BASE_DIR@
CPP_UNIT	= $(srcdir)/../../../../external/cppunit

CXX		= @CXX@
CFLAGS		= @CFLAGS@ $(OPTIMIZER) $(EXTRA_CFLAGS)
CPPFLAGS	= @CPPFLAGS@
CXXFLAGS	= @CXXFLAGS@ $(OPTIMIZER) $(EXTRA_CFLAGS)
DEFS		= @DEFS@ -DJCCL_TEST_DIR="\"$(JCCLROOT_ABS)/test/TestSuite\""
DEP_GEN_FLAG	= @DEP_GEN_FLAG@
DEPEND_FLAGS	= @DEPEND_FLAGS@ $(INCLUDES)
DEPEND_EXTRAS	= @DEPEND_EXTRAS@ $(DEFS)
EXTRA_CFLAGS	= @APP_EXTRA_CFLAGS@
EXTRA_LFLAGS	= @APP_EXTRA_LFLAGS@
INCLUDES	= @INCLUDES@ -I$(topdir) -I$(JCCL_BASE_DIR)/include	\
                  -I$(srcdir) -I$(srcdir)/TestCases -I$(CPP_UNIT)/include
OPTIMIZER	= @DBG_FLAGS@ -D_DEBUG
LD		= @LD@
LDFLAGS		= @LDFLAGS@ -L/usr/lib$(LIBBITSUF)
LIBBITSUF	= @LIBBITSUF@
LIBS		= @LIBS@ $(JCCL_LIBS)
MAKEDEPEND	= @MAKEDEPEND@
OBJEXT		= @OBJEXT@
OBJ_NAME_FLAG	= @OBJ_NAME_FLAG@
OS_TYPE		= @OS_TYPE@

USE_MAKEDEPEND	= @USE_MAKEDEPEND@

ifeq (@PLATFORM@, IRIX)
    INCLUDES	+= -I$(VPR_BASE_DIR)/include/boost/compatibility/cpp_c_headers
endif

LINK		= $(CXX) $(CPPFLAGS) $(CXXFLAGS) @EXTRA_LINK_FLAGS@	\
                  $(EXTRA_LFLAGS)

LN_S            = @LN_S@

JCCL_LIBS	= @APP_BASIC_LIBS_BEGIN@ @APP_BASIC_LIBS@		\
                  @APP_BASIC_EXT_LIBS@ @APP_BASIC_LIBS_END@		\
                  $(NULL)
EXTRA_LIBS	= @APP_EXTRA_LIBS_BEGIN@ @APP_EXTRA_LIBS@		\
                  @APP_EXTRA_LIBS_END@					\
                  $(NULL)

# -----------------------------------------------------------------------------
# Compiler command lines.
# -----------------------------------------------------------------------------
C_COMPILE	= $(CC) $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CFLAGS)
CXX_COMPILE	= $(CXX) $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CXXFLAGS)

# objects to be included in the project....
# SRC Files
TEST_SRCS = 
CPPUNIT_TEXTUI_SRCS = TextTestResult.cpp TextTestRunner.cpp
CPPUNIT_SRCS	= Exception.cpp		\
                  NotEqualException.cpp	\
                  TestAssert.cpp	\
                  TestCase.cpp		\
                  TestResult.cpp	\
                  TestFailure.cpp	\
                  TestSuite.cpp

RUNNER_SRCS	= main.cpp
SRCS		= $(TEST_SRCS)			\
                  $(CPPUNIT_TEXTUI_SRCS)	\
                  $(CPPUNIT_SRCS)		\
                  $(RUNNER_SRCS)

OBJDIR = .
DEPDIR = 

INCLUDE_PATHS = 
PATH_TO_SRCS = $(srcdir) $(srcdir)/TestCases $(CPP_UNIT)/src/cppunit
MK_DIR = $(srcdir)/../../../../share/mk

include $(MK_DIR)/objs.mk

# Compile then Link
$(PROJECT_NAME): $(OBJS) $(JCCL_BASE_DIR)/lib$(LIBBITSUF)/libjccl.a
	@echo ""
	@echo "-------------------------------------------"
	@echo "Linking... (.$(OBJEXT)'s --> executable)"
	@echo "-------------------------------------------"
	$(LINK) -o $@ $(OBJS) $(LDFLAGS) $(LIBS) $(EXTRA_LIBS)
	@echo ""
	@echo "Copying test files..."
	$(LN_S) $(srcdir)/TestFiles .
	@echo "-------------------------------------------"
	@echo "$(PROJECT_NAME) done"
	@echo "-------------------------------------------"

echo_info:
	@echo ""
	@echo "Building $(PROJECT_NAME)"
	@echo "Using JCCL_BASE_DIR: $(JCCL_BASE_DIR)"
	@echo ""

# Remove the compiled stuff from the system
clean:
	@echo ""
	@echo "-------------------------------------------"
	@echo "Removing compiled stuff from the system	 "
	@echo "-------------------------------------------"
	rm -fr $(OBJS) $(PROJECT_NAME) *.ncb *.opt *.plg *.ilk *.idb	\
          *.pdb *.pch Debug/ Release/ ii_files/ *core

clobber: clean
	rm -f *.d

include $(MK_DIR)/depend.mk

